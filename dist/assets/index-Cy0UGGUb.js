import{d as L,r as c,a as M,c as $,e,w as o,f as s,o as k,b as r,h as d,i as z,j as A,k as G,g as u,t as H,l as J,T as K,m as O,n as Q,u as W,E as f}from"./index-CYHUCKG_.js";import{u as X,c as Y}from"./user-DKGzpPxU.js";import{_ as Z}from"./_plugin-vue_export-helper-COv-dAod.js";const ee={class:"layout"},oe={class:"header-right"},te={class:"user-info"},se=L({__name:"index",setup(ne){const C=z(),h=W(),w=X(),l=c(!1),i=c(!1),_=c(),a=M({currentPassword:"",newPassword:""}),F={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}]},R=m=>{switch(m){case"changePassword":l.value=!0;break;case"logout":g();break}},g=()=>{w.logout(),h.push("/login"),f.success("已退出登录")},B=async()=>{_.value&&await _.value.validate(async m=>{if(m){i.value=!0;try{await Y(a),f.success("密码修改成功"),l.value=!1,g()}catch(t){f.error(t.message||"密码修改失败")}finally{i.value=!1}}})};return(m,t)=>{const p=s("el-icon"),v=s("el-menu-item"),E=s("el-menu"),U=s("el-aside"),b=s("el-dropdown-item"),N=s("el-dropdown-menu"),S=s("el-dropdown"),T=s("el-header"),q=s("router-view"),D=s("el-main"),P=s("el-container"),x=s("el-input"),V=s("el-form-item"),j=s("el-form"),y=s("el-button"),I=s("el-dialog");return k(),$("div",ee,[e(P,null,{default:o(()=>[e(U,{width:"200px"},{default:o(()=>[t[6]||(t[6]=r("div",{class:"logo"}," 用户管理系统 ",-1)),e(E,{router:!0,"default-active":d(C).path,class:"menu","background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF"},{default:o(()=>[e(v,{index:"/dashboard"},{default:o(()=>[e(p,null,{default:o(()=>[e(d(A))]),_:1}),t[4]||(t[4]=r("span",null,"仪表盘",-1))]),_:1}),e(v,{index:"/users"},{default:o(()=>[e(p,null,{default:o(()=>[e(d(G))]),_:1}),t[5]||(t[5]=r("span",null,"用户管理",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),e(P,null,{default:o(()=>[e(T,null,{default:o(()=>[r("div",oe,[e(S,{onCommand:R},{dropdown:o(()=>[e(N,null,{default:o(()=>[e(b,{command:"changePassword"},{default:o(()=>t[7]||(t[7]=[u(" 修改密码 ")])),_:1}),e(b,{command:"logout",divided:""},{default:o(()=>t[8]||(t[8]=[u(" 退出登录 ")])),_:1})]),_:1})]),default:o(()=>[r("span",te,[u(H(d(w).username)+" ",1),e(p,null,{default:o(()=>[e(d(J))]),_:1})])]),_:1})])]),_:1}),e(D,null,{default:o(()=>[e(q,null,{default:o(({Component:n})=>[e(K,{name:"fade",mode:"out-in"},{default:o(()=>[(k(),O(Q(n)))]),_:2},1024)]),_:1})]),_:1})]),_:1})]),_:1}),e(I,{modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=n=>l.value=n),title:"修改密码",width:"400px"},{footer:o(()=>[e(y,{onClick:t[2]||(t[2]=n=>l.value=!1)},{default:o(()=>t[9]||(t[9]=[u("取消")])),_:1}),e(y,{type:"primary",onClick:B,loading:i.value},{default:o(()=>t[10]||(t[10]=[u(" 确认 ")])),_:1},8,["loading"])]),default:o(()=>[e(j,{ref_key:"passwordFormRef",ref:_,model:a,rules:F,"label-width":"100px"},{default:o(()=>[e(V,{label:"当前密码",prop:"currentPassword"},{default:o(()=>[e(x,{modelValue:a.currentPassword,"onUpdate:modelValue":t[0]||(t[0]=n=>a.currentPassword=n),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(V,{label:"新密码",prop:"newPassword"},{default:o(()=>[e(x,{modelValue:a.newPassword,"onUpdate:modelValue":t[1]||(t[1]=n=>a.newPassword=n),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),de=Z(se,[["__scopeId","data-v-7a00d918"]]);export{de as default};
