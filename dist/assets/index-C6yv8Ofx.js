import{g as x}from"./users-Chko-4zv.js";import{d as w,r as _,q as D,c as T,e as s,w as t,f as i,o as U,b as a,t as d,g as b}from"./index-CYHUCKG_.js";import{_ as y}from"./_plugin-vue_export-helper-COv-dAod.js";const E={class:"dashboard-container"},N={class:"card-content"},V={class:"card-content"},k={class:"card-content"},C=w({__name:"index",setup(B){const l=_({totalUsers:0,vipUsers:0,expiringUsers:0}),u=_([]),m=n=>{const e=new Date,r=new Date(e.getTime()+30*24*60*60*1e3);l.value.totalUsers=n.length,l.value.vipUsers=n.filter(o=>new Date(o.vipExpireTime)>e).length,l.value.expiringUsers=n.filter(o=>{const c=new Date(o.vipExpireTime);return c>e&&c<=r}).length},v=async()=>{try{const n=await x();m(n),u.value=n.sort((e,r)=>new Date(r.vipExpireTime).getTime()-new Date(e.vipExpireTime).getTime()).slice(0,5)}catch(n){console.error("获取数据失败:",n)}},f=n=>new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return D(()=>{v()}),(n,e)=>{const r=i("el-card"),o=i("el-col"),c=i("el-row"),p=i("el-table-column"),h=i("el-table");return U(),T("div",E,[s(c,{gutter:20},{default:t(()=>[s(o,{span:8},{default:t(()=>[s(r,{class:"stat-card"},{header:t(()=>e[0]||(e[0]=[a("div",{class:"card-header"},[a("span",null,"总用户数")],-1)])),default:t(()=>[a("div",N,[a("h1",null,d(l.value.totalUsers),1)])]),_:1})]),_:1}),s(o,{span:8},{default:t(()=>[s(r,{class:"stat-card"},{header:t(()=>e[1]||(e[1]=[a("div",{class:"card-header"},[a("span",null,"VIP用户数")],-1)])),default:t(()=>[a("div",V,[a("h1",null,d(l.value.vipUsers),1)])]),_:1})]),_:1}),s(o,{span:8},{default:t(()=>[s(r,{class:"stat-card"},{header:t(()=>e[2]||(e[2]=[a("div",{class:"card-header"},[a("span",null,"即将过期用户")],-1)])),default:t(()=>[a("div",k,[a("h1",null,d(l.value.expiringUsers),1)])]),_:1})]),_:1})]),_:1}),s(r,{class:"chart-card"},{header:t(()=>e[3]||(e[3]=[a("div",{class:"card-header"},[a("span",null,"最近添加的用户")],-1)])),default:t(()=>[s(h,{data:u.value,style:{width:"100%"}},{default:t(()=>[s(p,{prop:"username",label:"用户名"}),s(p,{prop:"userToken",label:"用户Token"}),s(p,{prop:"vipExpireTime",label:"VIP到期时间"},{default:t(({row:g})=>[b(d(f(g.vipExpireTime)),1)]),_:1})]),_:1},8,["data"])]),_:1})])}}}),q=y(C,[["__scopeId","data-v-787fe0f3"]]);export{q as default};
